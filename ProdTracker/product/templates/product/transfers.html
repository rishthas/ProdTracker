{% extends "product/base.html" %}

{% load i18n %}

{% load static %}

{% block head_title %} {% trans "Transfers" %} {% endblock head_title %}<

{% block heading %} {% trans "Transfers" %}{% endblock heading %}

{% block pagecss %}
    <link rel="stylesheet" href="{% static 'plugins/datatables-bs4/css/dataTables.bootstrap4.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/datatables-responsive/css/responsive.bootstrap4.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/datatables-buttons/css/buttons.bootstrap4.min.css' %}">

  <link rel="stylesheet" href="{% static 'plugins/daterangepicker/daterangepicker.css' %}">
  <!-- iCheck for checkboxes and radio inputs -->
  <link rel="stylesheet" href="{% static 'plugins/icheck-bootstrap/icheck-bootstrap.min.css' %}">
  <!-- Bootstrap Color Picker -->
  <link rel="stylesheet" href="{% static 'plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css' %}">
  <!-- Tempusdominus Bootstrap 4 -->
  <link rel="stylesheet" href="{% static 'plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css' %}">
  <!-- Select2 -->
  <link rel="stylesheet" href="{% static 'plugins/select2/css/select2.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css' %}">
  <!-- Bootstrap4 Duallistbox -->
  <link rel="stylesheet" href="{% static 'plugins/bootstrap4-duallistbox/bootstrap-duallistbox.min.css' %}">
  <!-- BS Stepper -->
  <link rel="stylesheet" href="{% static 'plugins/bs-stepper/css/bs-stepper.min.css' %}">
  <!-- dropzonejs -->
  <link rel="stylesheet" href="{% static 'plugins/dropzone/min/dropzone.min.css' %}">
   <link rel="stylesheet" href="{% static 'plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css' %}">
  <!-- Toastr -->
  <link rel="stylesheet" href="{% static 'plugins/toastr/toastr.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/datatables-select/css/select.bootstrap4.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/datatables-scroller/css/scroller.bootstrap4.min.css' %}">
  <style>
    th{
				white-space: nowrap ;
				text-align: center; 
    			vertical-align: middle;
          padding-left: 10px;
			}
      td{
				white-space: nowrap ;
				text-align: center; 
    			vertical-align: middle;
          padding:0;
			}
      #overlay {
        background: #ffffff;
        color: #666666;
        position: fixed;
        height: 100%;
        width: 100%;
        z-index: 5000;
        top: 0;
        left: 0;
        float: left;
        text-align: center;
        padding-top: 25%;
        opacity: .80;
      }
      button {
        margin: 40px;
        padding: 5px 20px;
        cursor: pointer;
      }
      .spinner {
          margin: 0 auto;
          height: 64px;
          width: 64px;
          animation: rotate 0.8s infinite linear;
          border: 5px solid firebrick;
          border-right-color: transparent;
          border-radius: 50%;
      }
      @keyframes rotate {
          0% {
              transform: rotate(0deg);
          }
          100% {
              transform: rotate(360deg);
          }
      }
  </style>
{% endblock pagecss %}

 {% block breadcrums %}
    <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">{% trans "Home" %}</a></li>
        <li class="breadcrumb-item"><a href="{% url 'transfer' %}">{% trans "Transfers" %}</a></li>
        
    </ol>
{% endblock breadcrums %}

{% block maincontent %}
{% if messages %}
            
    {% for message in messages %}
    {% comment %} <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li> {% endcomment %}
    
    <div class="alert alert-custom alert-primary" role="alert">
        <div class="alert-icon">
            <div class="alert-text"><i class="fa fa-check-circle"></i>  {% if message.tags %}{{ message.tags|title}}{% endif %} : {{ message }}!</div>                    
        </div>
        
    </div>
    {% endfor %}


{% endif %}
<div class="card">
              <div class="card-header">
                <h3 class="card-title">List of Transfers</h3>
              </div>
              <!-- /.card-header -->
              <div class="card-body">
                <table id="example1" class="table table-bordered table-striped ">
                  <thead class="thead-dark">
                  <tr>
                    <th>Transfer Date</th>
                    <th>Event Time</th>
                    <th>Vendor Code</th>
                    <th>Vendor Name</th>
                    <th>Model No</th>
                    <th>Serial Number</th>
                    <th>Branch Code</th>
                    <th>Branch Name</th>
                    <th>Status</th>
                    <th>Remarks</th>
                    

                  </tr>
                  </thead>
                  
                  
                </table>
              </div>
              <!-- /.card-body -->
            </div>
{% endblock maincontent %}


{% block pagejs %}
    <script>var csrf_token = '{{csrf_token}}';</script>

    <script src="{% static 'plugins/datatables/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-bs4/js/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-responsive/js/dataTables.responsive.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-responsive/js/responsive.bootstrap4.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/dataTables.buttons.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/buttons.bootstrap4.min.js' %}"></script>
    <script src="{% static 'plugins/jszip/jszip.min.js' %}"></script>
    <script src="{% static 'plugins/pdfmake/pdfmake.min.js' %}"></script>
    <script src="{% static 'plugins/pdfmake/vfs_fonts.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/buttons.html5.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/buttons.print.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/buttons.colVis.min.js' %}"></script>
    <!-- Select2 -->
    <script src="{% static 'plugins/select2/js/select2.full.min.js' %}"></script>
    <!-- Bootstrap4 Duallistbox -->
    <script src="{% static 'plugins/bootstrap4-duallistbox/jquery.bootstrap-duallistbox.min.js' %}"></script>
    <!-- InputMask -->
    <script src="{% static 'plugins/moment/moment.min.js' %}"></script>
    <script src="{% static 'plugins/inputmask/jquery.inputmask.min.js' %}"></script>
    <!-- date-range-picker -->
    <script src="{% static 'plugins/daterangepicker/daterangepicker.js' %}"></script>
    <!-- bootstrap color picker -->
    <script src="{% static 'plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js' %}"></script>
    <!-- Tempusdominus Bootstrap 4 -->
    <script src="{% static 'plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js' %}"></script>
    <!-- Bootstrap Switch -->
    <script src="{% static 'plugins/bootstrap-switch/js/bootstrap-switch.min.js' %}"></script>
    <!-- BS-Stepper -->
    <script src="{% static 'plugins/bs-stepper/js/bs-stepper.min.js' %}"></script>
    <!-- dropzonejs -->
    <script src="{% static 'plugins/dropzone/min/dropzone.min.js' %}"></script>
    <script src="{% static 'plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <!-- SweetAlert2 -->
    <script src="{% static 'plugins/sweetalert2/sweetalert2.min.js' %}"></script>
    <!-- Toastr -->
    <script src="{% static 'plugins/toastr/toastr.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-select/js/dataTables.select.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-select/js/select.bootstrap4.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-scroller/js/dataTables.scroller.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-scroller/js/scroller.bootstrap4.min.js' %}"></script>
    <script>
        $(document).ready(function () {
          var datatable = $("#example1").DataTable({
                "scrollX": true,
                
                "autoWidth": true,
                
                "serverSide": true,
                "ajax": '/api/transfer/?format=datatables',
                columns: [
                  { data: 'date' },
                  { data: 'event_time' },
                  { data: 'product.model.vendor.code' },
                  { data: 'product.model.vendor.name' },
                  { data: 'product.model.name' },
                  { data: 'product.serial_num' },
                  { data: 'branch.code' },
                  { data: 'branch.name' },
                  { data: 'status'   },
                  { data: 'remark'   },
                  
                ],
                "initComplete": function(settings, json) {
                  $(".branch-delete").click(function(){
                    // alert($(this).attr("dataId"));
                    delete_branch($(this).attr("dataId"),$(this).attr("dataName"));
                  });
                },
                

            });

            function delete_branch(id,name) {
              if(confirm("Are you Sure on Deleting the Transfer ["+ name+"]. Note: All the transactions and product in this branch also will be deleted !!! ")){
                $.ajax({
                  headers: { "X-CSRFToken": csrf_token },
                  type: "DELETE",
                  url: "/api/branch/"+id+"/",
                  success: function(data, textStatus, xhr){
                    console.log("In Success");
                    console.log(xhr.status);
                    console.log(data);
                    alert("The Transfer is deleted")
                    datatable.ajax.reload();
                  },
                });
              }
              
            }
            
        });
    </script>
{% endblock pagejs %}
