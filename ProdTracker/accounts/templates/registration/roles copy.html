{% extends "product/base.html" %}
{% load static %}

{% load i18n %}

{% block head_title %} {% trans "Roles" %} {% endblock head_title %}<

{% block heading %} {% trans "Roles" %}{% endblock heading %}
{% block pagecss %}
    <link rel="stylesheet" href="{% static 'plugins/datatables-bs4/css/dataTables.bootstrap4.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/datatables-responsive/css/responsive.bootstrap4.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/datatables-buttons/css/buttons.bootstrap4.min.css' %}">

  <link rel="stylesheet" href="{% static 'plugins/daterangepicker/daterangepicker.css' %}">
  <!-- iCheck for checkboxes and radio inputs -->
  <link rel="stylesheet" href="{% static 'plugins/icheck-bootstrap/icheck-bootstrap.min.css' %}">
  <!-- Bootstrap Color Picker -->
  <link rel="stylesheet" href="{% static 'plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css' %}">
  <!-- Tempusdominus Bootstrap 4 -->
  <link rel="stylesheet" href="{% static 'plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css' %}">
  <!-- Select2 -->
  <link rel="stylesheet" href="{% static 'plugins/select2/css/select2.min.css' %}">
  <link rel="stylesheet" href="{% static 'plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css' %}">
  <!-- Bootstrap4 Duallistbox -->
  <link rel="stylesheet" href="{% static 'plugins/bootstrap4-duallistbox/bootstrap-duallistbox.min.css' %}">
  <!-- BS Stepper -->
  <link rel="stylesheet" href="{% static 'plugins/bs-stepper/css/bs-stepper.min.css' %}">
  <!-- dropzonejs -->
  <link rel="stylesheet" href="{% static 'plugins/dropzone/min/dropzone.min.css' %}">
   <link rel="stylesheet" href="{% static 'plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css' %}">
  <!-- Toastr -->
  <link rel="stylesheet" href="{% static 'plugins/toastr/toastr.min.css' %}">
{% endblock pagecss %}

 {% block breadcrums %}
    <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">{% trans "Home" %}</a></li>
        <li class="breadcrumb-item"><a href="#">{% trans "Roles" %}</a></li>
        
    </ol>
{% endblock breadcrums %}

{% block maincontent %}
<div class="card">
    <div class="card-header pl-7 bg-gradient-dark">
      <div class="row">
       <div class="col-6">
        <h2> {% trans "Roles" %}</h2>
       </div>
       <div class="col-6">
        <a href="{% url 'add-role' %}" class="btn btn-primary font-weight-bolder float-right" id="addEmp">
                <span class="svg-icon svg-icon-md">
                    
                    <i class="fa fa-plus-circle" aria-hidden="true"></i>
                </span> {% trans "Add" %}</a>
       </div>
       
      </div>
        
        

    </div>
    <div class="card-body">
        {% if messages %}
        
            {% for message in messages %}
            {% comment %} <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li> {% endcomment %}
                {% if 'add_club' in message.tags %}
                    <div class="alert alert-custom alert-primary" role="alert">
                        <div class="alert-icon">
                            <div class="alert-text"><i class="fa fa-check-circle"></i>  {% if message.tags %}{{ message.tags|title}}{% endif %} : {{ message }}!</div>                    
                        </div>
                        
                    </div>
                {% endif %}
                
            {% endfor %}
    
    
        {% endif %}
        <table id="example1" class="table table-bordered table-striped">
            <thead>
            <tr>
              <th>id</th>
              <th>{% trans "Role Id" %}</th>
              <th>  {% trans "Description" %}</th>
              <th>{% trans "Action" %}</th>
              

            </tr>
            </thead>
            
            
          </table>
        
        
            
            
        
    </div>
</div>
{% endblock maincontent%}


{% block pagejs %}
    <script>var csrf_token = '{{csrf_token}}';</script>

    <script src="{% static 'plugins/datatables/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-bs4/js/dataTables.bootstrap4.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-responsive/js/dataTables.responsive.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-responsive/js/responsive.bootstrap4.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/dataTables.buttons.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/buttons.bootstrap4.min.js' %}"></script>
    <script src="{% static 'plugins/jszip/jszip.min.js' %}"></script>
    <script src="{% static 'plugins/pdfmake/pdfmake.min.js' %}"></script>
    <script src="{% static 'plugins/pdfmake/vfs_fonts.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/buttons.html5.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/buttons.print.min.js' %}"></script>
    <script src="{% static 'plugins/datatables-buttons/js/buttons.colVis.min.js' %}"></script>
    <!-- Select2 -->
    <script src="{% static 'plugins/select2/js/select2.full.min.js' %}"></script>
    <!-- Bootstrap4 Duallistbox -->
    <script src="{% static 'plugins/bootstrap4-duallistbox/jquery.bootstrap-duallistbox.min.js' %}"></script>
    <!-- InputMask -->
    <script src="{% static 'plugins/moment/moment.min.js' %}"></script>
    <script src="{% static 'plugins/inputmask/jquery.inputmask.min.js' %}"></script>
    <!-- date-range-picker -->
    <script src="{% static 'plugins/daterangepicker/daterangepicker.js' %}"></script>
    <!-- bootstrap color picker -->
    <script src="{% static 'plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js' %}"></script>
    <!-- Tempusdominus Bootstrap 4 -->
    <script src="{% static 'plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js' %}"></script>
    <!-- Bootstrap Switch -->
    <script src="{% static 'plugins/bootstrap-switch/js/bootstrap-switch.min.js' %}"></script>
    <!-- BS-Stepper -->
    <script src="{% static 'plugins/bs-stepper/js/bs-stepper.min.js' %}"></script>
    <!-- dropzonejs -->
    <script src="{% static 'plugins/dropzone/min/dropzone.min.js' %}"></script>
    <script src="{% static 'plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
    <!-- SweetAlert2 -->
    <script src="{% static 'plugins/sweetalert2/sweetalert2.min.js' %}"></script>
    <!-- Toastr -->
    <script src="{% static 'plugins/toastr/toastr.min.js' %}"></script>
    <script>
        $(document).ready(function () {
            var datatable = $("#example1").DataTable({
                "responsive": true,
                "lengthChange": true,
                "autoWidth": true,
                "processing": true,
                "buttons": ["copy", "csv", "excel", "pdf", "print", "colvis"],
                "serverSide": true,
                "ajax": '/api/roles/?format=datatables',
                "language": {
                    "emptyTable": {% trans '"No Role Available"' %},
                    "processing": '<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i><span class="sr-only">{% trans "Loading" %}...</span> ',
                  },
                columns: [
                    { data: 'id' ,"visible": false},

                    { data: 'role_id' },
                    { data: 'description' },
                    {
                        data: 'Action', "searchable": false, "orderable": false, "className": "align-middle text-center",
                        "render": function (data, type, full, meta) {
                            console.log(full)
                            var rtn_str = "";
                            rtn_str = rtn_str + '<a dataId="' + full.id + '"  class="terminal-edit"  href="/user_account/role/edit/' + full.id + '/" title="Edit Role">\
							          <i class="fas fa-edit text-primary"></i>\
                        </a>\
                        <a dataId="'+ full.id + '" dataName="' + full.name + '" class="role-delete" title="Delete">\
                          <i class="fas fa-trash text-danger"></i>\
                        </a>\
                        ';
                            return rtn_str;

                        },

                    },
                ],
                "initComplete": function(settings, json) {
                  $(".role-delete").click(function(){
                    // alert($(this).attr("dataId"));
                    delete_role($(this).attr("dataId"),$(this).attr("dataName"));
                  });
                },


            });

            function delete_role(id,name) {
              if(confirm({% trans '"Are you Sure on Deleting the Branch ["' %}+ name+ {% trans '"]"' %})){
                $.ajax({
                  headers: { "X-CSRFToken": csrf_token },
                  type: "DELETE",
                  url: "/api/roles/"+id+"/",
                  success: function(data, textStatus, xhr){
                    console.log("In Success");
                    console.log(xhr.status);
                    console.log(data);
                    alert("The Role is deleted")
                    datatable.ajax.reload();
                  },
                });
              }
              
            }
            
        });
    </script>
{% endblock pagejs %}
